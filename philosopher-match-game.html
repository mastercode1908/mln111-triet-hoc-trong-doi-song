<!DOCTYPE html>
<html class="light" lang="vi">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Gh√©p ƒë√¥i Tri·∫øt gia | PhiloMap</title>
    <!-- Fonts & Icons -->
    <link href="https://fonts.googleapis.com" rel="preconnect" />
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect" />
    <link
        href="https://fonts.googleapis.com/css2?family=Lexend:wght@300;400;500;600;700&family=Lora:wght@400;500;600;700&display=swap"
        rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap"
        rel="stylesheet" />
    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com?plugins=forms"></script>
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#308ce8",
                        "secondary": "#10b981",
                        "accent": "#f59e0b",
                        "academic": "#8b5cf6",
                        "background-light": "#f8f9fa",
                        "background-dark": "#111921",
                    },
                    fontFamily: {
                        "sans": ["Lexend", "sans-serif"],
                        "serif": ["Lora", "serif"],
                    },
                    animation: {
                        'flip': 'flip 0.6s ease-in-out',
                        'bounce-in': 'bounceIn 0.5s ease-out',
                        'success-glow': 'successGlow 2s infinite',
                    },
                    keyframes: {
                        flip: {
                            '0%': { transform: 'rotateY(0deg)' },
                            '50%': { transform: 'rotateY(90deg)' },
                            '100%': { transform: 'rotateY(0deg)' },
                        },
                        bounceIn: {
                            '0%': { transform: 'scale(0.8)', opacity: '0' },
                            '70%': { transform: 'scale(1.1)' },
                            '100%': { transform: 'scale(1)', opacity: '1' },
                        },
                        successGlow: {
                            '0%, 100%': { boxShadow: '0 0 10px #10b981' },
                            '50%': { boxShadow: '0 0 20px #10b981' },
                        }
                    }
                },
            },
        }
    </script>
    <style>
        .material-symbols-outlined {
            font-family: 'Material Symbols Outlined';
            font-weight: normal;
            font-style: normal;
            font-size: 24px;
            display: inline-block;
            line-height: 1;
            text-transform: none;
            letter-spacing: normal;
            word-wrap: normal;
            white-space: nowrap;
            direction: ltr;
            font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        }

        /* Card flip animation */
        .card {
            transform-style: preserve-3d;
            transition: transform 0.6s;
            cursor: pointer;
        }

        .card.flipped {
            transform: rotateY(180deg);
        }

        .card-front,
        .card-back {
            backface-visibility: hidden;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1rem;
            text-align: center;
        }

        .card-back {
            transform: rotateY(180deg);
        }

        /* Confetti effect */
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            top: -10px;
            z-index: 9999;
            border-radius: 50%;
        }

        /* Academic badge */
        .academic-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 28px;
            height: 28px;
            background: #8b5cf6;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            z-index: 10;
            cursor: pointer;
        }

        /* Modal scroll */
        .modal-scroll {
            max-height: 70vh;
            overflow-y: auto;
        }

        /* Custom scrollbar */
        .modal-scroll::-webkit-scrollbar {
            width: 8px;
        }

        .modal-scroll::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }

        .modal-scroll::-webkit-scrollbar-thumb {
            background: #8b5cf6;
            border-radius: 4px;
        }

        .modal-scroll::-webkit-scrollbar-thumb:hover {
            background: #7c3aed;
        }
    </style>
</head>

<body
    class="bg-background-light dark:bg-background-dark text-slate-800 dark:text-gray-200 font-sans min-h-screen overflow-x-hidden flex flex-col">
    <!-- Header -->
    <div id="header-placeholder"></div>

    <!-- Game Container -->
    <main class="flex-grow">
        <!-- Welcome Modal -->
        <div id="welcome-modal"
            class="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4">
            <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-md w-full p-5 relative">
                <!-- Close Button -->
                <button id="btn-close-modal"
                    class="absolute top-3 right-3 p-1 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                    <span
                        class="material-symbols-outlined text-gray-400 hover:text-gray-600 dark:hover:text-gray-300">close</span>
                </button>
                <div class="text-center">
                    <span class="material-symbols-outlined text-academic text-4xl mb-2">menu_book</span>
                    <h2 class="text-2xl font-bold text-slate-900 dark:text-white mb-3">
                        Gh√©p ƒë√¥i Tri·∫øt gia
                    </h2>
                    <div class="bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4 mb-4">
                        <h3 class="font-bold text-sm text-slate-900 dark:text-white mb-2">
                            üéØ M·ª•c ti√™u Game
                        </h3>
                        <p class="text-slate-700 dark:text-gray-300 text-xs leading-relaxed">
                            Gh√©p c·∫∑p <strong>Tri·∫øt gia</strong> v·ªõi <strong>C√¢u n√≥i n·ªïi ti·∫øng</strong> c·ªßa h·ªç.
                            Ho√†n th√†nh 8 c·∫∑p tr∆∞·ªõc khi h·∫øt th·ªùi gian.
                        </p>
                    </div>
                    <div class="text-left mb-4">
                        <h4 class="font-bold text-xs text-slate-900 dark:text-white mb-1">
                            üìö C√°ch ch∆°i:
                        </h4>
                        <ul class="text-xs text-slate-600 dark:text-gray-400 space-y-0.5">
                            <li>‚Ä¢ Nh·∫•n v√†o th·∫ª ƒë·ªÉ l·∫≠t m·∫∑t</li>
                            <li>‚Ä¢ T√¨m c·∫∑p th·∫ª: <strong>Tri·∫øt gia</strong> ‚Üî <strong>C√¢u n√≥i</strong></li>
                            <li>‚Ä¢ Gh√©p ƒë√∫ng 8 c·∫∑p tr∆∞·ªõc khi h·∫øt 120 gi√¢y</li>
                            <li>‚Ä¢ D√πng g·ª£i √Ω khi c·∫ßn (3 l·∫ßn)</li>
                        </ul>
                    </div>

                    <!-- Example Cards -->
                    <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-3 mb-4">
                        <h4 class="font-bold text-xs text-slate-900 dark:text-white mb-2">
                            üé¥ V√≠ d·ª• c·∫∑p gh√©p:
                        </h4>
                        <div class="flex justify-center items-center gap-2">
                            <div
                                class="w-20 h-16 bg-primary text-white rounded-lg flex flex-col items-center justify-center p-1.5 shadow">
                                <div class="text-[10px] font-bold">Tri·∫øt gia</div>
                                <div class="text-xs font-medium">Socrates</div>
                            </div>
                            <span class="material-symbols-outlined text-primary text-lg">sync_alt</span>
                            <div
                                class="w-20 h-16 bg-secondary text-white rounded-lg flex flex-col items-center justify-center p-1.5 shadow">
                                <div class="text-[10px] font-bold">Tr√≠ch d·∫´n</div>
                                <div class="text-[9px] font-medium text-center leading-tight">"T√¥i bi·∫øt r·∫±ng t√¥i kh√¥ng
                                    bi·∫øt g√¨ c·∫£"</div>
                            </div>
                        </div>
                    </div>

                    <button id="btn-start-game"
                        class="w-full px-6 py-3 bg-gradient-to-r from-primary to-blue-600 text-white font-bold rounded-xl shadow-lg hover:shadow-xl transition-all transform hover:scale-105">
                        <span class="flex items-center justify-center gap-2">
                            <span class="material-symbols-outlined">play_arrow</span>
                            B·∫Øt ƒë·∫ßu ch∆°i
                        </span>
                    </button>
                </div>
            </div>
        </div>

        <div class="max-w-7xl mx-auto px-4 md:px-10 py-8">
            <!-- Header -->
            <div class="text-center mb-10 animate-bounce-in">
                <h1 class="text-4xl md:text-5xl font-serif font-bold text-slate-900 dark:text-white mb-4">
                    üìñ <span class="text-academic">Gh√©p ƒë√¥i</span> Tri·∫øt gia
                </h1>
                <p class="text-lg text-slate-600 dark:text-gray-400 max-w-2xl mx-auto">
                    Gh√©p c·∫∑p tri·∫øt gia v·ªõi c√¢u n√≥i n·ªïi ti·∫øng c·ªßa h·ªç.
                </p>
            </div>

            <!-- Game Stats -->
            <div class="w-full mb-8">
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                    <div class="bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-lg text-center">
                        <div class="text-3xl font-bold text-primary mb-2" id="score">0</div>
                        <div class="text-sm text-slate-500 dark:text-gray-400">ƒêI·ªÇM S·ªê</div>
                    </div>
                    <div class="bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-lg text-center">
                        <div class="text-3xl font-bold text-secondary mb-2" id="timer">120</div>
                        <div class="text-sm text-slate-500 dark:text-gray-400">TH·ªúI GIAN</div>
                    </div>
                    <div class="bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-lg text-center">
                        <div class="text-3xl font-bold text-accent mb-2" id="pairs-matched">0/8</div>
                        <div class="text-sm text-slate-500 dark:text-gray-400">C·∫∂P ƒê√É GH√âP</div>
                    </div>
                    <div class="bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-lg text-center">
                        <div class="text-3xl font-bold text-academic mb-2" id="hints-left">3</div>
                        <div class="text-sm text-slate-500 dark:text-gray-400">G·ª¢I √ù C√íN L·∫†I</div>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="w-full mb-6">
                <div class="text-center space-y-4">
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                        <button id="hint-btn"
                            class="w-full justify-center px-4 py-3 bg-academic hover:bg-purple-700 text-white rounded-xl text-sm font-medium transition-colors flex items-center gap-2 shadow-sm hover:shadow-md">
                            <span class="material-symbols-outlined text-xl">lightbulb</span>
                            G·ª£i √Ω
                        </button>
                        <button id="show-sources-btn"
                            class="w-full justify-center px-4 py-3 bg-blue-500 hover:bg-blue-600 text-white rounded-xl text-sm font-medium transition-colors flex items-center gap-2 shadow-sm hover:shadow-md">
                            <span class="material-symbols-outlined text-xl">library_books</span>
                            Ngu·ªìn
                        </button>
                        <button id="restart-btn"
                            class="w-full justify-center px-4 py-3 bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 text-slate-700 dark:text-gray-300 rounded-xl text-sm font-medium transition-colors flex items-center gap-2 shadow-sm hover:shadow-md">
                            <span class="material-symbols-outlined text-xl">restart_alt</span>
                            Ch∆°i l·∫°i
                        </button>
                        <button id="help-btn"
                            class="w-full justify-center px-4 py-3 bg-amber-500 hover:bg-amber-600 text-white rounded-xl text-sm font-medium transition-colors flex items-center gap-2 shadow-sm hover:shadow-md">
                            <span class="material-symbols-outlined text-xl">help</span>
                            H∆∞·ªõng d·∫´n
                        </button>
                    </div>
                </div>
            </div>

            <!-- Game Grid -->
            <div class="w-full">
                <div class="grid grid-cols-2 md:grid-cols-4 gap-6 mb-8" id="game-grid">
                    <!-- Cards will be generated by JavaScript -->
                </div>
            </div>
        </div>

        <!-- Help Modal -->
        <div id="help-modal"
            class="hidden fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4">
            <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-lg w-full p-5 relative">
                <!-- Close Button -->
                <button id="btn-close-help"
                    class="absolute top-3 right-3 p-1 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                    <span
                        class="material-symbols-outlined text-gray-400 hover:text-gray-600 dark:hover:text-gray-300">close</span>
                </button>
                <div class="text-center mb-4">
                    <span class="material-symbols-outlined text-amber-500 text-4xl mb-2">help</span>
                    <h2 class="text-xl font-bold text-slate-900 dark:text-white">H∆∞·ªõng d·∫´n ch∆°i</h2>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="space-y-3">
                        <h4 class="font-bold text-sm flex items-center gap-2">
                            <span class="material-symbols-outlined text-primary text-lg">play_circle</span>
                            C√°ch ch∆°i
                        </h4>
                        <ul class="space-y-2 text-xs text-slate-600 dark:text-gray-400">
                            <li class="flex items-start gap-2">
                                <span class="text-primary font-bold">1.</span>
                                <span>Nh·∫•n v√†o th·∫ª ƒë·ªÉ l·∫≠t m·∫∑t</span>
                            </li>
                            <li class="flex items-start gap-2">
                                <span class="text-primary font-bold">2.</span>
                                <span>T√¨m c·∫∑p th·∫ª: <strong>Tri·∫øt gia</strong> ‚Üî <strong>C√¢u n√≥i</strong></span>
                            </li>
                            <li class="flex items-start gap-2">
                                <span class="text-primary font-bold">3.</span>
                                <span>Gh√©p ƒë√∫ng 8 c·∫∑p tr∆∞·ªõc khi h·∫øt th·ªùi gian</span>
                            </li>
                            <li class="flex items-start gap-2">
                                <span class="text-primary font-bold">4.</span>
                                <span>D√πng g·ª£i √Ω khi c·∫ßn (3 l·∫ßn)</span>
                            </li>
                        </ul>
                    </div>
                    <div class="space-y-3">
                        <h4 class="font-bold text-sm flex items-center gap-2">
                            <span class="material-symbols-outlined text-academic text-lg">school</span>
                            Gi√° tr·ªã h·ªçc thu·∫≠t
                        </h4>
                        <ul class="space-y-2 text-xs text-slate-600 dark:text-gray-400">
                            <li class="flex items-start gap-2">
                                <span class="text-academic font-bold">‚Ä¢</span>
                                <span>M·ªói c√¢u n√≥i ƒë·ªÅu c√≥ <strong>tr√≠ch d·∫´n ngu·ªìn</strong></span>
                            </li>
                            <li class="flex items-start gap-2">
                                <span class="text-academic font-bold">‚Ä¢</span>
                                <span>Theo <strong>gi√°o tr√¨nh Tri·∫øt h·ªçc M√°c - L√™nin</strong></span>
                            </li>
                            <li class="flex items-start gap-2">
                                <span class="text-academic font-bold">‚Ä¢</span>
                                <span>Li√™n k·∫øt v·ªõi <strong>Module PhiloMap</strong></span>
                            </li>
                            <li class="flex items-start gap-2">
                                <span class="text-academic font-bold">‚Ä¢</span>
                                <span>Ph√π h·ª£p cho <strong>√¥n t·∫≠p v√† nghi√™n c·ª©u</strong></span>
                            </li>
                        </ul>
                    </div>
                </div>
                <button id="btn-close-help-bottom"
                    class="w-full mt-4 px-6 py-2 bg-amber-500 hover:bg-amber-600 text-white font-bold rounded-xl transition-colors">
                    ƒê√£ hi·ªÉu
                </button>
            </div>
        </div>

        <!-- Source Modal -->
        <div id="source-modal" class="hidden fixed inset-0 bg-black/70 z-50 flex items-center justify-center p-4">
            <div
                class="bg-white dark:bg-gray-800 rounded-3xl max-w-2xl w-full max-h-[90vh] overflow-hidden flex flex-col">
                <div class="p-6 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
                    <h3 class="text-2xl font-bold text-slate-900 dark:text-white flex items-center gap-2">
                        <span class="material-symbols-outlined text-academic">menu_book</span>
                        <span id="modal-title">Ngu·ªìn tham kh·∫£o</span>
                    </h3>
                    <button onclick="closeSourceModal()"
                        class="p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg">
                        <span class="material-symbols-outlined">close</span>
                    </button>
                </div>

                <div class="p-6 overflow-y-auto flex-grow modal-scroll" id="source-content">
                    <!-- Content will be loaded here -->
                </div>
            </div>
        </div>

        <!-- Game Logic -->
        <script>
            // ==================== ACADEMIC DATA ====================
            const academicPairs = [
                {
                    id: 1,
                    philosopher: "Socrates",
                    quote: "T√¥i bi·∫øt r·∫±ng t√¥i kh√¥ng bi·∫øt g√¨ c·∫£",
                    explanation: "C√¢u n√≥i th·ªÉ hi·ªán ph∆∞∆°ng ph√°p bi·ªán ch·ª©ng Socrates: b·∫Øt ƒë·∫ßu t·ª´ s·ª± khi√™m t·ªën nh·∫≠n th·ª©c ƒë·ªÉ ƒëi t√¨m ch√¢n l√Ω.",
                    module: "Module 1: Nh·∫≠p m√¥n Tri·∫øt h·ªçc",
                    sources: [
                        {
                            type: "primary",
                            citation: "Plato, Apology, 21d",
                            description: "Trong 'L·ªùi Bi·ªán h·ªô c·ªßa Socrates', Plato ghi l·∫°i l·ªùi Socrates tr∆∞·ªõc t√≤a √°n Athens: 'ƒêi·ªÅu t√¥i bi·∫øt ch·∫Øc l√† t√¥i kh√¥ng bi·∫øt g√¨ c·∫£'."
                        },
                        {
                            type: "textbook",
                            citation: "Gi√°o tr√¨nh Tri·∫øt h·ªçc M√°c - L√™nin (2021), tr. 45",
                            description: "Socrates l√† ƒë·∫°i di·ªán ti√™u bi·ªÉu c·ªßa tri·∫øt h·ªçc Hy L·∫°p c·ªï ƒë·∫°i, ph∆∞∆°ng ph√°p ƒë·ªëi tho·∫°i bi·ªán ch·ª©ng c·ªßa √¥ng ƒë·∫∑t n·ªÅn m√≥ng cho logic h·ªçc."
                        }
                    ]
                },
                {
                    id: 2,
                    philosopher: "Karl Marx",
                    quote: "C√°c nh√† tri·∫øt h·ªçc ch·ªâ gi·∫£i th√≠ch th·∫ø gi·ªõi b·∫±ng nhi·ªÅu c√°ch kh√°c nhau; v·∫•n ƒë·ªÅ l√† thay ƒë·ªïi th·∫ø gi·ªõi",
                    explanation: "Lu·∫≠n ƒëi·ªÉm 11 trong 'Lu·∫≠n c∆∞∆°ng v·ªÅ Feuerbach', th·ªÉ hi·ªán b·∫£n ch·∫•t c√°ch m·∫°ng c·ªßa tri·∫øt h·ªçc M√°c.",
                    module: "Module 4: Tri·∫øt h·ªçc M√°c - L√™nin",
                    sources: [
                        {
                            type: "primary",
                            citation: "K. Marx, Lu·∫≠n c∆∞∆°ng v·ªÅ Feuerbach (1845), Lu·∫≠n ƒëi·ªÉm 11",
                            description: "Nguy√™n vƒÉn: 'C√°c nh√† tri·∫øt h·ªçc ch·ªâ gi·∫£i th√≠ch th·∫ø gi·ªõi b·∫±ng nhi·ªÅu c√°ch kh√°c nhau; song v·∫•n ƒë·ªÅ l√† c·∫£i t·∫°o th·∫ø gi·ªõi.'"
                        },
                        {
                            type: "textbook",
                            citation: "Gi√°o tr√¨nh Tri·∫øt h·ªçc M√°c - L√™nin (2021), tr. 215",
                            description: "Lu·∫≠n ƒëi·ªÉm n√†y th·ªÉ hi·ªán s·ª± kh√°c bi·ªát cƒÉn b·∫£n gi·ªØa tri·∫øt h·ªçc M√°c v·ªõi c√°c tri·∫øt h·ªçc tr∆∞·ªõc ƒë√≥: g·∫Øn l√Ω lu·∫≠n v·ªõi th·ª±c ti·ªÖn c√°ch m·∫°ng."
                        }
                    ]
                },
                {
                    id: 3,
                    philosopher: "V.I. Lenin",
                    quote: "V·∫≠t ch·∫•t l√† m·ªôt ph·∫°m tr√π tri·∫øt h·ªçc d√πng ƒë·ªÉ ch·ªâ th·ª±c t·∫°i kh√°ch quan... ƒë∆∞·ª£c ƒëem l·∫°i cho con ng∆∞·ªùi trong c·∫£m gi√°c",
                    explanation: "ƒê·ªãnh nghƒ©a kinh ƒëi·ªÉn v·ªÅ v·∫≠t ch·∫•t trong ch·ªß nghƒ©a duy v·∫≠t bi·ªán ch·ª©ng.",
                    module: "Module 2: Ch·ªß nghƒ©a duy v·∫≠t",
                    sources: [
                        {
                            type: "primary",
                            citation: "V.I. Lenin, Ch·ªß nghƒ©a duy v·∫≠t v√† ch·ªß nghƒ©a kinh nghi·ªám ph√™ ph√°n (1909), Ch∆∞∆°ng 2",
                            description: "ƒê·ªãnh nghƒ©a ƒë·∫ßy ƒë·ªß: 'V·∫≠t ch·∫•t l√† m·ªôt ph·∫°m tr√π tri·∫øt h·ªçc d√πng ƒë·ªÉ ch·ªâ th·ª±c t·∫°i kh√°ch quan ƒë∆∞·ª£c ƒëem l·∫°i cho con ng∆∞·ªùi trong c·∫£m gi√°c...'"
                        },
                        {
                            type: "textbook",
                            citation: "Gi√°o tr√¨nh Tri·∫øt h·ªçc M√°c - L√™nin (2021), tr. 87",
                            description: "ƒê·ªãnh nghƒ©a n√†y kh·∫Øc ph·ª•c quan ni·ªám si√™u h√¨nh v·ªÅ v·∫≠t ch·∫•t, x√°c l·∫≠p quan ƒëi·ªÉm duy v·∫≠t bi·ªán ch·ª©ng v·ªÅ m·ªëi quan h·ªá v·∫≠t ch·∫•t - √Ω th·ª©c."
                        }
                    ]
                },
                {
                    id: 4,
                    philosopher: "Friedrich Engels",
                    quote: "V·∫≠n ƒë·ªông l√† ph∆∞∆°ng th·ª©c t·ªìn t·∫°i c·ªßa v·∫≠t ch·∫•t",
                    explanation: "Nguy√™n l√Ω c∆° b·∫£n c·ªßa ph√©p bi·ªán ch·ª©ng duy v·∫≠t v·ªÅ t√≠nh v·∫≠n ƒë·ªông c·ªßa th·∫ø gi·ªõi v·∫≠t ch·∫•t.",
                    module: "Module 2: Ph√©p bi·ªán ch·ª©ng",
                    sources: [
                        {
                            type: "primary",
                            citation: "F. Engels, Bi·ªán ch·ª©ng c·ªßa t·ª± nhi√™n (1873-1882)",
                            description: "Engels vi·∫øt: 'V·∫≠n ƒë·ªông... l√† ph∆∞∆°ng th·ª©c t·ªìn t·∫°i c·ªßa v·∫≠t ch·∫•t.'"
                        },
                        {
                            type: "textbook",
                            citation: "Gi√°o tr√¨nh Tri·∫øt h·ªçc M√°c - L√™nin (2021), tr. 102",
                            description: "Nguy√™n l√Ω n√†y ph·ªß nh·∫≠n quan ni·ªám si√™u h√¨nh v·ªÅ v·∫≠t ch·∫•t tƒ©nh t·∫°i, kh·∫≥ng ƒë·ªãnh th·∫ø gi·ªõi v·∫≠t ch·∫•t lu√¥n v·∫≠n ƒë·ªông v√† ph√°t tri·ªÉn."
                        }
                    ]
                },
                {
                    id: 5,
                    philosopher: "H·ªì Ch√≠ Minh",
                    quote: "Th·ª±c ti·ªÖn kh√¥ng c√≥ l√Ω lu·∫≠n h∆∞·ªõng d·∫´n th√¨ th√†nh th·ª±c ti·ªÖn m√π qu√°ng. L√Ω lu·∫≠n m√† kh√¥ng li√™n h·ªá v·ªõi th·ª±c ti·ªÖn l√† l√Ω lu·∫≠n su√¥ng",
                    explanation: "Quan ƒëi·ªÉm v·ªÅ m·ªëi quan h·ªá bi·ªán ch·ª©ng gi·ªØa l√Ω lu·∫≠n v√† th·ª±c ti·ªÖn.",
                    module: "Module 3: L√Ω lu·∫≠n v√† th·ª±c ti·ªÖn",
                    sources: [
                        {
                            type: "primary",
                            citation: "H·ªì Ch√≠ Minh, To√†n t·∫≠p, T·∫≠p 5, tr. 234",
                            description: "Tr√≠ch t·ª´ b√†i 'N√¢ng cao ƒë·∫°o ƒë·ª©c c√°ch m·∫°ng, qu√©t s·∫°ch ch·ªß nghƒ©a c√° nh√¢n' (1969)."
                        },
                        {
                            type: "textbook",
                            citation: "Gi√°o tr√¨nh Tri·∫øt h·ªçc M√°c - L√™nin (2021), tr. 156",
                            description: "T∆∞ t∆∞·ªüng n√†y v·∫≠n d·ª•ng s√°ng t·∫°o nguy√™n l√Ω th·ªëng nh·∫•t gi·ªØa l√Ω lu·∫≠n v√† th·ª±c ti·ªÖn c·ªßa ch·ªß nghƒ©a M√°c v√†o ƒëi·ªÅu ki·ªán Vi·ªát Nam."
                        }
                    ]
                },
                {
                    id: 6,
                    philosopher: "Plato",
                    quote: "Tri th·ª©c l√† nh·ªõ l·∫°i",
                    explanation: "Thuy·∫øt h·ªìi ·ª©c (Anamnesis) - linh h·ªìn b·∫•t t·ª≠ ƒë√£ bi·∫øt m·ªçi ch√¢n l√Ω tr∆∞·ªõc khi nh·∫≠p v√†o th·ªÉ x√°c.",
                    module: "Module 1: L·ªãch s·ª≠ tri·∫øt h·ªçc",
                    sources: [
                        {
                            type: "primary",
                            citation: "Plato, Meno, 81c-d",
                            description: "Socrates ch·ª©ng minh thuy·∫øt h·ªìi ·ª©c qua vi·ªác d·∫°y m·ªôt n√¥ l·ªá ch∆∞a h·ªçc h√¨nh h·ªçc gi·∫£i b√†i to√°n."
                        },
                        {
                            type: "secondary",
                            citation: "Bertrand Russell, L·ªãch s·ª≠ Tri·∫øt h·ªçc Ph∆∞∆°ng T√¢y, tr. 120",
                            description: "Plato cho r·∫±ng linh h·ªìn b·∫•t t·ª≠ ƒë√£ t·ª´ng chi√™m ng∆∞·ª°ng c√°c √ù ni·ªám ·ªü th·∫ø gi·ªõi si√™u vi·ªát, n√™n tri th·ª©c th·ª±c ch·∫•t l√† nh·ªõ l·∫°i."
                        }
                    ]
                },
                {
                    id: 7,
                    philosopher: "Immanuel Kant",
                    quote: "H√£y d√°m bi·∫øt! H√£y c√≥ can ƒë·∫£m s·ª≠ d·ª•ng l√Ω tr√≠ c·ªßa ch√≠nh m√¨nh",
                    explanation: "Kh·∫©u hi·ªáu c·ªßa Khai s√°ng (Aufkl√§rung), ƒë·ªÅ cao t·ª± do t∆∞ duy v√† tho√°t kh·ªèi s·ª± v·ªã th√†nh ni√™n t·ª± g√°n cho m√¨nh.",
                    module: "Module 1: Tri·∫øt h·ªçc Khai s√°ng",
                    sources: [
                        {
                            type: "primary",
                            citation: "I. Kant, Tr·∫£ l·ªùi c√¢u h·ªèi: Khai s√°ng l√† g√¨? (1784)",
                            description: "Nguy√™n vƒÉn: 'Sapere aude! H√£y c√≥ can ƒë·∫£m s·ª≠ d·ª•ng l√Ω tr√≠ c·ªßa ch√≠nh m√¨nh! ƒê√≥ l√† ph∆∞∆°ng ch√¢m c·ªßa Khai s√°ng.'"
                        },
                        {
                            type: "secondary",
                            citation: "Gi√°o tr√¨nh L·ªãch s·ª≠ Tri·∫øt h·ªçc, tr. 189",
                            description: "Kant ƒë·ªãnh nghƒ©a Khai s√°ng l√† s·ª± tho√°t kh·ªèi t√¨nh tr·∫°ng v·ªã th√†nh ni√™n do ch√≠nh con ng∆∞·ªùi t·ª± g√°n cho m√¨nh."
                        }
                    ]
                },
                {
                    id: 8,
                    philosopher: "Aristotle",
                    quote: "Con ng∆∞·ªùi l√† ƒë·ªông v·∫≠t c√≥ l√Ω tr√≠",
                    explanation: "ƒê·ªãnh nghƒ©a b·∫£n ch·∫•t con ng∆∞·ªùi qua thu·ªôc t√≠nh ƒë·∫∑c tr∆∞ng l√† logos (l√Ω tr√≠, ng√¥n ng·ªØ).",
                    module: "Module 5: Tri·∫øt h·ªçc v·ªÅ con ng∆∞·ªùi",
                    sources: [
                        {
                            type: "primary",
                            citation: "Aristotle, Ch√≠nh tr·ªã h·ªçc, 1253a",
                            description: "Aristotle vi·∫øt: 'Con ng∆∞·ªùi l√† ƒë·ªông v·∫≠t c√≥ l√Ω tr√≠ (zoon logon echon) v√† l√† ƒë·ªông v·∫≠t ch√≠nh tr·ªã (zoon politikon).'"
                        },
                        {
                            type: "textbook",
                            citation: "Gi√°o tr√¨nh Tri·∫øt h·ªçc M√°c - L√™nin (2021), tr. 278",
                            description: "Quan ƒëi·ªÉm n√†y nh·∫•n m·∫°nh b·∫£n ch·∫•t x√£ h·ªôi v√† t∆∞ duy c·ªßa con ng∆∞·ªùi, ph√¢n bi·ªát v·ªõi c√°c lo√†i ƒë·ªông v·∫≠t kh√°c."
                        }
                    ]
                }
            ];

            // ==================== GAME STATE ====================
            let score = 0;
            let timer = 120;
            let timerInterval = null;
            let matchedPairs = 0;
            let totalPairs = 8;
            let flippedCards = [];
            let canFlip = true;
            let hintsLeft = 3;
            let gameActive = true;

            // ==================== GAME INITIALIZATION ====================
            function initGame() {
                const grid = document.getElementById('game-grid');
                grid.innerHTML = '';

                // Create cards array (philosopher + quote pairs)
                let cards = [];
                academicPairs.forEach(pair => {
                    // Philosopher card
                    cards.push({
                        type: 'philosopher',
                        content: pair.philosopher,
                        pairId: pair.id,
                        color: '#308ce8',
                        pairData: pair
                    });
                    // Quote card
                    cards.push({
                        type: 'quote',
                        content: pair.quote,
                        pairId: pair.id,
                        color: '#10b981',
                        pairData: pair
                    });
                });

                // Shuffle cards
                cards = shuffleArray(cards);

                // Create card elements
                cards.forEach((card, index) => {
                    const cardEl = document.createElement('div');
                    cardEl.className = 'relative h-48 cursor-pointer perspective';
                    cardEl.dataset.index = index;
                    cardEl.dataset.pairId = card.pairId;
                    cardEl.dataset.type = card.type;

                    cardEl.innerHTML = `
                    <div class="card w-full h-full">
                        <!-- Front of card -->
                        <div class="card-front bg-white dark:bg-gray-700 border-2 border-gray-200 dark:border-gray-600">
                            <div class="text-center">
                                <div class="text-3xl mb-2">üìñ</div>
                                <div class="text-sm text-gray-500 dark:text-gray-400">Nh·∫•n ƒë·ªÉ l·∫≠t</div>
                                <div class="text-xs text-academic mt-2">C√≥ tr√≠ch d·∫´n</div>
                            </div>
                        </div>
                        
                        <!-- Back of card -->
                        <div class="card-back text-white" style="background: ${card.color}">
                            <div class="academic-badge" onclick="showCardSource(${card.pairId}, event)">
                                i
                            </div>
                            <div class="w-full h-full flex flex-col items-center justify-center p-4">
                                <div class="font-bold text-lg mb-2">
                                    ${card.type === 'philosopher' ? 'Tri·∫øt gia' : 'Tr√≠ch d·∫´n'}
                                </div>
                                <div class="text-sm font-medium leading-tight">
                                    ${card.content}
                                </div>
                                ${card.type === 'quote' ?
                            `<div class="text-xs opacity-80 mt-3">${card.pairData.module}</div>` : ''}
                            </div>
                        </div>
                    </div>
                `;

                    cardEl.addEventListener('click', () => flipCard(cardEl));
                    grid.appendChild(cardEl);
                });

                // Start timer
                startTimer();
                updateStats();
            }

            // ==================== GAME LOGIC ====================
            function flipCard(cardEl) {
                if (!canFlip || !gameActive) return;
                if (flippedCards.length >= 2) return;
                if (cardEl.classList.contains('matched')) return;
                if (flippedCards.includes(cardEl)) return;

                const card = cardEl.querySelector('.card');
                card.classList.add('flipped');
                flippedCards.push(cardEl);

                // Check for match when 2 cards are flipped
                if (flippedCards.length === 2) {
                    canFlip = false;

                    const card1 = flippedCards[0];
                    const card2 = flippedCards[1];

                    if (card1.dataset.pairId === card2.dataset.pairId) {
                        // Match found!
                        setTimeout(() => {
                            card1.classList.add('matched');
                            card2.classList.add('matched');
                            card1.style.opacity = '0.7';
                            card2.style.opacity = '0.7';

                            score += 100;
                            matchedPairs++;

                            // Show academic explanation
                            const pair = academicPairs.find(p => p.id == card1.dataset.pairId);
                            showAcademicMatch(pair);

                            updateStats();

                            // Check win condition
                            if (matchedPairs === totalPairs) {
                                endGame(true);
                            }

                            flippedCards = [];
                            canFlip = true;
                        }, 800);
                    } else {
                        // No match
                        setTimeout(() => {
                            card1.querySelector('.card').classList.remove('flipped');
                            card2.querySelector('.card').classList.remove('flipped');
                            flippedCards = [];
                            canFlip = true;
                        }, 1500);
                    }
                }
            }

            function showAcademicMatch(pair) {
                // Create notification
                const notification = document.createElement('div');
                notification.className = 'fixed top-4 right-4 z-40 p-5 rounded-xl shadow-lg max-w-sm animate-bounce-in bg-white dark:bg-gray-800 border-l-4 border-green-500';

                notification.innerHTML = `
                <div class="flex items-start">
                    <div class="flex-shrink-0 mt-1 text-green-500">
                        <span class="material-symbols-outlined">check_circle</span>
                    </div>
                    <div class="ml-3">
                        <p class="font-bold text-slate-900 dark:text-white">‚úÖ Gh√©p ƒë√∫ng: ${pair.philosopher}</p>
                        <p class="text-sm text-slate-700 dark:text-gray-300 mt-1">${pair.explanation}</p>
                        
                        <div class="mt-3 p-3 bg-green-50 dark:bg-green-900/20 rounded-lg">
                            <div class="text-xs font-bold text-green-700 dark:text-green-300 mb-1">TR√çCH D·∫™N H·ªåC THU·∫¨T:</div>
                            <div class="text-xs text-gray-600 dark:text-gray-400">
                                ${pair.sources[0].citation}
                            </div>
                            <button onclick="showFullPairSource(${pair.id})" 
                                    class="mt-2 text-xs text-green-600 dark:text-green-400 hover:underline">
                                Xem ƒë·∫ßy ƒë·ªß ngu·ªìn tham kh·∫£o ‚Üí
                            </button>
                        </div>
                        
                        <button onclick="this.parentElement.parentElement.parentElement.remove()" 
                                class="mt-3 text-xs text-gray-500 hover:text-gray-700">
                            ƒê√≥ng
                        </button>
                    </div>
                </div>
            `;

                document.body.appendChild(notification);

                // Auto-remove after 5 seconds
                setTimeout(() => {
                    if (notification.parentElement) {
                        notification.remove();
                    }
                }, 5000);
            }

            // ==================== SOURCE VIEWING ====================
            function showCardSource(pairId, event) {
                if (event) event.stopPropagation();
                const pair = academicPairs.find(p => p.id === pairId);
                if (!pair) return;

                document.getElementById('modal-title').textContent = `Ngu·ªìn tham kh·∫£o: ${pair.philosopher}`;

                const content = document.getElementById('source-content');
                content.innerHTML = `
                <div class="space-y-6">
                    <div>
                        <h4 class="font-bold text-lg text-slate-900 dark:text-white mb-2">${pair.philosopher}</h4>
                        <blockquote class="p-4 bg-gray-50 dark:bg-gray-700 rounded-xl italic border-l-4 border-academic">
                            "${pair.quote}"
                        </blockquote>
                        <p class="text-sm text-slate-600 dark:text-gray-400 mt-3">${pair.explanation}</p>
                        <div class="mt-2">
                            <span class="px-3 py-1 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 text-xs rounded-full">
                                ${pair.module}
                            </span>
                        </div>
                    </div>
                    
                    <div>
                        <h5 class="font-bold text-slate-900 dark:text-white mb-3">Ngu·ªìn tham kh·∫£o h·ªçc thu·∫≠t</h5>
                        <div class="space-y-4">
                            ${pair.sources.map((source, index) => `
                                <div class="p-4 ${index === 0 ? 'bg-blue-50 dark:bg-blue-900/20' : 'bg-gray-50 dark:bg-gray-700'} rounded-xl">
                                    <div class="flex items-center gap-2 mb-2">
                                        <span class="px-2 py-1 ${source.type === 'primary' ? 'bg-academic/20 text-academic' : 'bg-green-100 text-green-700'} text-xs rounded-full">
                                            ${source.type === 'primary' ? 'Ngu·ªìn nguy√™n b·∫£n' : 'Gi√°o tr√¨nh'}
                                        </span>
                                    </div>
                                    <div class="font-mono text-sm">${source.citation}</div>
                                    <div class="text-sm text-gray-600 dark:text-gray-400 mt-2">${source.description}</div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    
                    <div class="p-4 bg-gray-50 dark:bg-gray-700 rounded-xl">
                        <h5 class="font-bold text-slate-900 dark:text-white mb-2">üìö H·ªçc s√¢u h∆°n tr√™n PhiloMap</h5>
                        <p class="text-sm text-slate-600 dark:text-gray-400">
                            ƒê·ªÉ hi·ªÉu s√¢u h∆°n v·ªÅ ${pair.philosopher} v√† t∆∞ t∆∞·ªüng c·ªßa √¥ng, h√£y nghi√™n c·ª©u:
                        </p>
                        <ul class="mt-2 space-y-1 text-sm">
                            <li class="flex items-center gap-2">
                                <span class="material-symbols-outlined text-xs text-academic">arrow_forward</span>
                                <span>Module li√™n quan: <strong>${pair.module}</strong></span>
                            </li>
                            <li class="flex items-center gap-2">
                                <span class="material-symbols-outlined text-xs text-academic">arrow_forward</span>
                                <span>B√†i t·∫≠p th·ª±c h√†nh v·ªÅ ${pair.philosopher}</span>
                            </li>
                            <li class="flex items-center gap-2">
                                <span class="material-symbols-outlined text-xs text-academic">arrow_forward</span>
                                <span>T√†i li·ªáu tham kh·∫£o b·ªï sung trong th∆∞ vi·ªán</span>
                            </li>
                        </ul>
                    </div>
                </div>
            `;

                document.getElementById('source-modal').classList.remove('hidden');
            }

            function showFullPairSource(pairId) {
                const pair = academicPairs.find(p => p.id === pairId);
                showCardSource(pairId, { stopPropagation: () => { } });
            }

            function closeSourceModal() {
                document.getElementById('source-modal').classList.add('hidden');
            }

            // ==================== HINT SYSTEM ====================
            document.getElementById('hint-btn').addEventListener('click', function () {
                if (hintsLeft > 0 && gameActive) {
                    hintsLeft--;

                    // Find two unmatched cards that are a pair
                    const unmatchedCards = Array.from(document.querySelectorAll('#game-grid > div:not(.matched)'));
                    const pairs = {};

                    unmatchedCards.forEach(card => {
                        const pairId = card.dataset.pairId;
                        if (!pairs[pairId]) pairs[pairId] = [];
                        pairs[pairId].push(card);
                    });

                    // Find a pair that has both cards still hidden
                    for (const pairId in pairs) {
                        if (pairs[pairId].length === 2) {
                            // Briefly show both cards
                            pairs[pairId].forEach(card => {
                                card.querySelector('.card').classList.add('flipped');
                                setTimeout(() => {
                                    if (!card.classList.contains('matched')) {
                                        card.querySelector('.card').classList.remove('flipped');
                                    }
                                }, 1000);
                            });

                            // Show hint notification
                            const notification = document.createElement('div');
                            notification.className = 'fixed top-20 right-4 z-40 p-4 rounded-xl shadow-lg max-w-sm animate-bounce-in bg-academic text-white';
                            notification.innerHTML = `
                            <div class="flex items-center gap-3">
                                <span class="material-symbols-outlined">lightbulb</span>
                                <div>
                                    <p class="font-bold">G·ª£i √Ω</p>
                                    <p class="text-sm opacity-90">ƒê√£ hi·ªÉn th·ªã m·ªôt c·∫∑p th·∫ª trong 1 gi√¢y!</p>
                                </div>
                            </div>
                        `;

                            document.body.appendChild(notification);
                            setTimeout(() => notification.remove(), 2000);

                            updateStats();
                            return;
                        }
                    }

                    // If no pairs found
                    if (hintsLeft < 0) hintsLeft = 0;
                    updateStats();
                } else if (hintsLeft === 0 && gameActive) {
                    // Show notification when hints are exhausted
                    const notification = document.createElement('div');
                    notification.className = 'fixed top-20 right-4 z-40 p-4 rounded-xl shadow-lg max-w-sm animate-bounce-in bg-red-500 text-white';
                    notification.innerHTML = `
                        <div class="flex items-center gap-3">
                            <span class="material-symbols-outlined">warning</span>
                            <div>
                                <p class="font-bold">H·∫øt l∆∞·ª£t g·ª£i √Ω!</p>
                                <p class="text-sm opacity-90">B·∫°n ƒë√£ s·ª≠ d·ª•ng h·∫øt 3 l∆∞·ª£t g·ª£i √Ω. H√£y c·ªë g·∫Øng t·ª± t√¨m c√°c c·∫∑p c√≤n l·∫°i nh√©!</p>
                            </div>
                        </div>
                    `;
                    document.body.appendChild(notification);
                    setTimeout(() => notification.remove(), 3000);
                }
            });

            // ==================== SHOW ALL SOURCES ====================
            document.getElementById('show-sources-btn').addEventListener('click', function () {
                showAllReferences();
            });

            function showAllReferences() {
                document.getElementById('modal-title').textContent = 'To√†n b·ªô t√†i li·ªáu tham kh·∫£o h·ªçc thu·∫≠t';

                const content = document.getElementById('source-content');
                let referencesHTML = `
                <div class="space-y-8">
                    <div>
                        <h4 class="text-xl font-bold text-slate-900 dark:text-white mb-4">üìö T√†i li·ªáu tham kh·∫£o ch√≠nh</h4>
                        <div class="space-y-4">
                            <div class="p-4 bg-blue-50 dark:bg-blue-900/20 rounded-xl">
                                <div class="font-bold text-blue-700 dark:text-blue-300 mb-2">Gi√°o tr√¨nh ch√≠nh th·ª©c</div>
                                <div class="text-sm">B·ªô Gi√°o d·ª•c v√† ƒê√†o t·∫°o (2021). <em>Gi√°o tr√¨nh Tri·∫øt h·ªçc M√°c - L√™nin</em>. Nh√† xu·∫•t b·∫£n Ch√≠nh tr·ªã Qu·ªëc gia S·ª± th·∫≠t.</div>
                                <div class="text-xs text-gray-500 dark:text-gray-400 mt-2">S·ª≠ d·ª•ng trong: Module 1-5, c√°c c√¢u h·ªèi tr·∫Øc nghi·ªám, ƒë·ªãnh nghƒ©a c∆° b·∫£n.</div>
                            </div>
                            
                            <div class="p-4 bg-green-50 dark:bg-green-900/20 rounded-xl">
                                <div class="font-bold text-green-700 dark:text-green-300 mb-2">T√°c ph·∫©m nguy√™n b·∫£n</div>
                                <div class="text-sm space-y-2">
                                    <div>‚Ä¢ Marx, K. & Engels, F. (1848). <em>Tuy√™n ng√¥n ƒê·∫£ng C·ªông s·∫£n</em>.</div>
                                    <div>‚Ä¢ Lenin, V.I. (1909). <em>Ch·ªß nghƒ©a duy v·∫≠t v√† ch·ªß nghƒ©a kinh nghi·ªám ph√™ ph√°n</em>.</div>
                                    <div>‚Ä¢ H·ªì Ch√≠ Minh (1969). <em>To√†n t·∫≠p, T·∫≠p 5</em>.</div>
                                    <div>‚Ä¢ Plato (‚âà380 TCN). <em>Apology, Meno, Phaedo</em>.</div>
                                    <div>‚Ä¢ Aristotle (‚âà350 TCN). <em>Ch√≠nh tr·ªã h·ªçc, Si√™u h√¨nh h·ªçc</em>.</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div>
                        <h4 class="text-xl font-bold text-slate-900 dark:text-white mb-4">üìñ Tr√≠ch d·∫´n theo t·ª´ng tri·∫øt gia</h4>
                        <div class="space-y-6">
            `;

                academicPairs.forEach(pair => {
                    referencesHTML += `
                    <div class="p-4 border border-gray-200 dark:border-gray-700 rounded-xl">
                        <div class="font-bold text-slate-900 dark:text-white mb-2">${pair.philosopher}</div>
                        <blockquote class="text-sm italic text-slate-600 dark:text-gray-400 mb-3 p-3 bg-gray-50 dark:bg-gray-800 rounded">"${pair.quote}"</blockquote>
                        <div class="text-sm text-slate-600 dark:text-gray-400 mb-3">${pair.explanation}</div>
                        <div class="text-xs space-y-3">
                            ${pair.sources.map(src => `
                                <div class="p-3 ${src.type === 'primary' ? 'bg-purple-50 dark:bg-purple-900/20' : 'bg-gray-50 dark:bg-gray-800'} rounded">
                                    <div class="flex items-center gap-2 mb-1">
                                        <span class="px-2 py-1 ${src.type === 'primary' ? 'bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-300' : 'bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300'} text-xs rounded-full">
                                            ${src.type === 'primary' ? 'Ngu·ªìn g·ªëc' : 'Gi√°o tr√¨nh'}
                                        </span>
                                    </div>
                                    <div class="font-mono text-xs">${src.citation}</div>
                                    <div class="text-gray-600 dark:text-gray-400 mt-1 text-xs">${src.description}</div>
                                </div>
                            `).join('')}
                        </div>
                        <div class="mt-3">
                            <span class="px-3 py-1 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 text-xs rounded-full">
                                ${pair.module}
                            </span>
                        </div>
                    </div>
                `;
                });

                referencesHTML += `
                        </div>
                    </div>
                    
                    <div class="p-4 bg-gray-50 dark:bg-gray-800 rounded-xl">
                        <h5 class="font-bold text-slate-900 dark:text-white mb-2">üéì Ph∆∞∆°ng ph√°p h·ªçc thu·∫≠t</h5>
                        <p class="text-sm text-slate-600 dark:text-gray-400 mb-3">
                            T·∫•t c·∫£ th√¥ng tin trong game n√†y ƒë∆∞·ª£c ki·ªÉm ch·ª©ng qua 3 b∆∞·ªõc:
                        </p>
                        <ol class="list-decimal pl-5 space-y-2 text-sm">
                            <li><strong>ƒê·ªëi chi·∫øu v·ªõi t√°c ph·∫©m nguy√™n b·∫£n</strong> (b·∫£n d·ªãch ch√≠nh th·ª©c)</li>
                            <li><strong>Ki·ªÉm tra qua gi√°o tr√¨nh</strong> ƒë∆∞·ª£c B·ªô GD&ƒêT ph√™ duy·ªát</li>
                            <li><strong>Tham kh·∫£o √Ω ki·∫øn chuy√™n gia</strong> tri·∫øt h·ªçc</li>
                        </ol>
                        <p class="mt-3 text-xs text-gray-500 dark:text-gray-400">
                            Game ƒë∆∞·ª£c thi·∫øt k·∫ø b·ªüi ƒë·ªôi ng≈© chuy√™n m√¥n PhiloMap, tham kh·∫£o √Ω ki·∫øn t·ª´ gi·∫£ng vi√™n Tri·∫øt h·ªçc t·∫°i ƒê·∫°i h·ªçc Khoa h·ªçc X√£ h·ªôi & Nh√¢n vƒÉn.
                        </p>
                    </div>
                </div>
            `;

                content.innerHTML = referencesHTML;
                document.getElementById('source-modal').classList.remove('hidden');
            }

            // ==================== GAME CONTROLS ====================
            function startTimer() {
                clearInterval(timerInterval);
                timer = 120;
                updateStats();

                timerInterval = setInterval(() => {
                    timer--;
                    updateStats();

                    if (timer <= 30) {
                        document.getElementById('timer').classList.add('text-red-500', 'animate-pulse');
                    }

                    if (timer <= 0) {
                        clearInterval(timerInterval);
                        endGame(false);
                    }
                }, 1000);
            }

            function updateStats() {
                document.getElementById('score').textContent = score;
                document.getElementById('timer').textContent = timer;
                document.getElementById('pairs-matched').textContent = `${matchedPairs}/${totalPairs}`;
                document.getElementById('hints-left').textContent = hintsLeft;
            }

            function endGame(isWin) {
                gameActive = false;
                clearInterval(timerInterval);

                // Calculate final score
                let timeBonus = timer * 2;
                let hintBonus = hintsLeft * 50;
                let finalScore = score + timeBonus + hintBonus;

                // Create results modal
                const modal = document.createElement('div');
                modal.className = 'fixed inset-0 bg-black/70 z-50 flex items-center justify-center p-4 animate-bounce-in';

                modal.innerHTML = `
                <div class="bg-gradient-to-br from-white to-blue-50 dark:from-gray-800 dark:to-blue-900/20 rounded-3xl p-8 max-w-md w-full shadow-2xl">
                    <div class="text-center">
                        <div class="w-20 h-20 ${isWin ? 'bg-green-100 dark:bg-green-900/30' : 'bg-red-100 dark:bg-red-900/30'} rounded-full flex items-center justify-center mx-auto mb-4 ${isWin ? 'text-green-500' : 'text-red-500'}">
                            <span class="material-symbols-outlined text-4xl">
                                ${isWin ? 'emoji_events' : 'timer_off'}
                            </span>
                        </div>
                        
                        <h2 class="text-2xl font-bold text-slate-900 dark:text-white mb-2">
                            ${isWin ? 'üéâ Ho√†n th√†nh xu·∫•t s·∫Øc!' : '‚è∞ H·∫øt th·ªùi gian!'}
                        </h2>
                        
                        <div class="text-4xl font-black ${isWin ? 'text-green-500' : 'text-red-500'} mb-4">
                            ${isWin ? 'CHI·∫æN TH·∫ÆNG' : 'HO√ÄN TH√ÄNH'}
                        </div>
                        
                        <div class="space-y-4 mb-8">
                            <div class="grid grid-cols-2 gap-4">
                                <div class="bg-blue-50 dark:bg-blue-900/20 p-3 rounded-xl">
                                    <div class="text-sm text-blue-600 dark:text-blue-300">ƒêI·ªÇM S·ªê</div>
                                    <div class="text-2xl font-bold">${finalScore}</div>
                                </div>
                                <div class="bg-green-50 dark:bg-green-900/20 p-3 rounded-xl">
                                    <div class="text-sm text-green-600 dark:text-green-300">C·∫∂P GH√âP</div>
                                    <div class="text-2xl font-bold">${matchedPairs}/8</div>
                                </div>
                            </div>
                            
                            <div class="bg-gray-50 dark:bg-gray-800 p-4 rounded-xl">
                                <div class="text-sm text-gray-500 dark:text-gray-400 mb-2">CHI TI·∫æT ƒêI·ªÇM</div>
                                <div class="text-xs space-y-1">
                                    <div class="flex justify-between">
                                        <span>ƒêi·ªÉm gh√©p ƒë√¥i:</span>
                                        <span class="font-bold">${score}</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>Th∆∞·ªüng th·ªùi gian:</span>
                                        <span class="font-bold text-green-500">+${timeBonus}</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>Th∆∞·ªüng g·ª£i √Ω:</span>
                                        <span class="font-bold text-green-500">+${hintBonus}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="space-y-3">
                            <button onclick="restartGame()" 
                                    class="w-full px-6 py-3 bg-primary text-white rounded-xl font-bold hover:bg-blue-600 transition-colors">
                                <span class="material-symbols-outlined align-middle mr-2">restart_alt</span>
                                Ch∆°i l·∫°i
                            </button>
                            <button onclick="showAllReferences()" 
                                    class="w-full px-6 py-3 bg-academic text-white rounded-xl font-bold hover:bg-purple-700 transition-colors">
                                <span class="material-symbols-outlined align-middle mr-2">library_books</span>
                                Xem t·∫•t c·∫£ t√†i li·ªáu tham kh·∫£o
                            </button>
                            <button onclick="window.location.href='home.html'" 
                                    class="w-full px-6 py-3 border-2 border-gray-300 text-gray-700 dark:text-gray-300 rounded-xl font-bold hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors">
                                <span class="material-symbols-outlined align-middle mr-2">home</span>
                                V·ªÅ trang ch·ªß PhiloMap
                            </button>
                        </div>
                    </div>
                </div>
            `;

                document.body.appendChild(modal);

                // Create confetti if win
                if (isWin) {
                    createConfetti();
                }
            }

            function restartGame() {
                // Remove existing modals
                document.querySelectorAll('.fixed.inset-0.bg-black\\/70').forEach(el => {
                    if (el.id !== 'source-modal') {
                        el.remove();
                    }
                });

                // Reset game state
                score = 0;
                timer = 120;
                matchedPairs = 0;
                hintsLeft = 3;
                flippedCards = [];
                canFlip = true;
                gameActive = true;

                // Reinitialize game
                initGame();
            }

            // ==================== HELPER FUNCTIONS ====================
            function shuffleArray(array) {
                for (let i = array.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
                return array;
            }

            function createConfetti() {
                const colors = ['#308ce8', '#10b981', '#f59e0b', '#8b5cf6', '#ec4899'];

                for (let i = 0; i < 50; i++) {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * 100 + 'vw';
                    confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.width = Math.random() * 10 + 5 + 'px';
                    confetti.style.height = Math.random() * 10 + 5 + 'px';

                    document.body.appendChild(confetti);

                    // Animation
                    const animation = confetti.animate([
                        { transform: 'translateY(0) rotate(0deg)', opacity: 1 },
                        { transform: `translateY(${window.innerHeight}px) rotate(${Math.random() * 360}deg)`, opacity: 0 }
                    ], {
                        duration: Math.random() * 3000 + 2000,
                        easing: 'cubic-bezier(0.215, 0.610, 0.355, 1)'
                    });

                    animation.onfinish = () => confetti.remove();
                }
            }

            // ==================== INITIALIZE GAME ====================
            document.addEventListener('DOMContentLoaded', function () {
                // Don't start game immediately - wait for user to click start button
                const welcomeModal = document.getElementById('welcome-modal');
                const startBtn = document.getElementById('btn-start-game');
                const closeBtn = document.getElementById('btn-close-modal');

                // Handle start button click
                startBtn.addEventListener('click', function () {
                    welcomeModal.classList.add('hidden');
                    initGame();
                });

                // Handle close button click
                closeBtn.addEventListener('click', function () {
                    welcomeModal.classList.add('hidden');
                    initGame();
                });

                // ==================== HELP MODAL LOGIC ====================
                const helpBtn = document.getElementById('help-btn');
                const helpModal = document.getElementById('help-modal');
                const closeHelpBtn = document.getElementById('btn-close-help');
                const closeHelpBottomBtn = document.getElementById('btn-close-help-bottom');

                if (helpBtn && helpModal) {
                    helpBtn.addEventListener('click', () => {
                        helpModal.classList.remove('hidden');
                    });

                    const closeHelp = () => {
                        helpModal.classList.add('hidden');
                    };

                    if (closeHelpBtn) closeHelpBtn.addEventListener('click', closeHelp);
                    if (closeHelpBottomBtn) closeHelpBottomBtn.addEventListener('click', closeHelp);

                    // Close on backdrop click
                    helpModal.addEventListener('click', (e) => {
                        if (e.target === helpModal) {
                            closeHelp();
                        }
                    });
                }

                // Setup event listeners
                document.getElementById('restart-btn').addEventListener('click', restartGame);

                // Keyboard shortcuts
                document.addEventListener('keydown', function (e) {
                    if (e.key === 'r' || e.key === 'R') {
                        restartGame();
                    }
                    if (e.key === 'h' || e.key === 'H') {
                        document.getElementById('hint-btn').click();
                    }
                    if (e.key === 'Escape') {
                        closeSourceModal();
                        // Close results modal if exists
                        document.querySelectorAll('.fixed.inset-0.bg-black\\/70').forEach(el => {
                            if (el.id !== 'source-modal') {
                                el.remove();
                            }
                        });
                    }
                });
            });
        </script>
        </div>
    </main>

    <!-- Footer -->
    <div id="footer-placeholder"></div>

    <!-- Load Components -->
    <script src="js/load-components.js"></script>
    <script src="js/tet-effect.js"></script>
</body>

</html>